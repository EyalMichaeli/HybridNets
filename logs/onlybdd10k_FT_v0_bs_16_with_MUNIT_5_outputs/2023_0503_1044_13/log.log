2023-05-03 10:44:13,556 INFO Loading train dataset
2023-05-03 10:44:13,910 INFO Avaliable images: 60000
2023-05-03 10:44:13,911 INFO Running on 10000 images
2023-05-03 10:44:13,923 INFO building database...
2023-05-03 10:44:15,827 INFO database build finish
2023-05-03 10:44:15,827 INFO Using MUNIT output from /mnt/raid/home/eyal_michaeli/git/imaginaire/logs/2023_0421_1405_28_ampO1_lower_LR/inference_cp_400k_style_std_1.5_on_new_10k/
2023-05-03 10:44:15,829 INFO Loading validation dataset
2023-05-03 10:44:15,888 INFO Avaliable images: 10000
2023-05-03 10:44:15,888 INFO Running on 3300 images
2023-05-03 10:44:15,889 INFO building database...
2023-05-03 10:44:16,511 INFO database build finish
2023-05-03 10:44:16,511 INFO Not using MUNIT output
2023-05-03 10:44:19,108 INFO [Warning] Ignoring Error(s) in loading state_dict for HybridNetsBackbone:
	size mismatch for classifier.header.pointwise_conv.conv.weight: copying a param with shape torch.Size([9, 160, 1, 1]) from checkpoint, the shape in current model is torch.Size([36, 160, 1, 1]).
	size mismatch for classifier.header.pointwise_conv.conv.bias: copying a param with shape torch.Size([9]) from checkpoint, the shape in current model is torch.Size([36]).
2023-05-03 10:44:19,109 INFO [Warning] Don't panic if you see this, this might be because you load a pretrained weights with different number of classes. The rest of the weights should be loaded already.
2023-05-03 10:44:19,109 INFO [Info] Successfully!!!
2023-05-03 10:44:19,199 INFO Epoch 1/50
2023-05-03 10:45:37,589 INFO Step: 100. Epoch: 1/50. Iteration: 101/625. Cls loss: 2182.478. Reg loss: 3.319. Seg loss: 1.940. Total loss: 2187.737
2023-05-03 10:46:45,986 INFO Step: 200. Epoch: 1/50. Iteration: 201/625. Cls loss: 1528.085. Reg loss: 3.473. Seg loss: 1.730. Total loss: 1533.288
2023-05-03 10:47:52,361 INFO Step: 300. Epoch: 1/50. Iteration: 301/625. Cls loss: 910.463. Reg loss: 3.210. Seg loss: 2.070. Total loss: 915.743
2023-05-03 10:48:59,484 INFO Step: 400. Epoch: 1/50. Iteration: 401/625. Cls loss: 835.668. Reg loss: 3.338. Seg loss: 1.786. Total loss: 840.791
2023-05-03 10:50:04,358 INFO Saved checkpoint to: ./logs/onlybdd10k_FT_v0_bs_16_with_MUNIT_5_outputs/2023_0503_1044_13/checkpoints/hybridnets-d3_0_500.pth
2023-05-03 10:50:04,687 INFO Step: 500. Epoch: 1/50. Iteration: 501/625. Cls loss: 1484.616. Reg loss: 2.941. Seg loss: 1.935. Total loss: 1489.492
2023-05-03 10:51:12,535 INFO Step: 600. Epoch: 1/50. Iteration: 601/625. Cls loss: 1304.202. Reg loss: 3.497. Seg loss: 1.726. Total loss: 1309.425
2023-05-03 10:51:25,474 INFO Validating...
2023-05-03 10:51:25,483 INFO Calculating mAP... will take one hour or more...
2023-05-03 11:57:54,162 INFO Val. Epoch: 1/50. Classification loss: 1230.92370. Regression loss: 2.90189. Segmentation loss: 1.89552. Total loss: 1235.72111
2023-05-03 12:11:00,283 INFO                                                                                                        road                             lane                             
2023-05-03 12:11:00,283 INFO Class          Images     Labels     P          R          mAP@.5     mAP@.5:.95 mIoU       mAcc       mIoU       IoU        Acc        mIoU       IoU        Acc        
2023-05-03 12:11:00,284 INFO all            3300       35234      0.000153   0.751      0.0111     0.00552    0.705      0.921      0.903      0.836      0.945      0.64       0.31       0.868      
2023-05-03 12:11:00,284 INFO car            3300       33233      0.000501   0.903      0.0378     0.0189     
2023-05-03 12:11:00,284 INFO bus            3300       556        6.99e-05   0.906      0.00513    0.00242    
2023-05-03 12:11:00,284 INFO truck          3300       1439       4.13e-05   0.862      0.00158    0.000787   
2023-05-03 12:11:00,284 INFO train          3300       6          1.18e-07   0.333      1.03e-07   1.03e-08   
2023-05-03 12:11:01,768 INFO Epoch 2/50
2023-05-03 12:12:01,691 INFO Step: 700. Epoch: 2/50. Iteration: 76/625. Cls loss: 2950.434. Reg loss: 2.977. Seg loss: 1.447. Total loss: 2954.858
2023-05-03 12:13:12,629 INFO Step: 800. Epoch: 2/50. Iteration: 176/625. Cls loss: 521.478. Reg loss: 3.348. Seg loss: 1.577. Total loss: 526.403
2023-05-03 12:14:25,038 INFO Step: 900. Epoch: 2/50. Iteration: 276/625. Cls loss: 1412.039. Reg loss: 2.865. Seg loss: 1.326. Total loss: 1416.231
2023-05-03 12:15:34,963 INFO Saved checkpoint to: ./logs/onlybdd10k_FT_v0_bs_16_with_MUNIT_5_outputs/2023_0503_1044_13/checkpoints/hybridnets-d3_1_1000.pth
2023-05-03 12:15:35,361 INFO Step: 1000. Epoch: 2/50. Iteration: 376/625. Cls loss: 1071.895. Reg loss: 2.603. Seg loss: 1.679. Total loss: 1076.177
2023-05-03 12:16:48,033 INFO Step: 1100. Epoch: 2/50. Iteration: 476/625. Cls loss: 2390.000. Reg loss: 3.036. Seg loss: 1.660. Total loss: 2394.697
2023-05-03 12:17:58,532 INFO Step: 1200. Epoch: 2/50. Iteration: 576/625. Cls loss: 2599.555. Reg loss: 2.606. Seg loss: 1.610. Total loss: 2603.772
2023-05-03 12:18:32,994 INFO Validating...
2023-05-03 12:33:58,766 INFO Val. Epoch: 2/50. Classification loss: 1201.28256. Regression loss: 2.91300. Segmentation loss: 1.66093. Total loss: 1205.85650
2023-05-03 12:33:58,953 INFO Epoch 3/50
2023-05-03 12:34:41,647 INFO Step: 1300. Epoch: 3/50. Iteration: 51/625. Cls loss: 704.448. Reg loss: 3.174. Seg loss: 1.472. Total loss: 709.093
2023-05-03 12:35:52,059 INFO Step: 1400. Epoch: 3/50. Iteration: 151/625. Cls loss: 758.914. Reg loss: 2.902. Seg loss: 1.356. Total loss: 763.172
2023-05-03 12:37:04,973 INFO Saved checkpoint to: ./logs/onlybdd10k_FT_v0_bs_16_with_MUNIT_5_outputs/2023_0503_1044_13/checkpoints/hybridnets-d3_2_1500.pth
2023-05-03 12:37:05,337 INFO Step: 1500. Epoch: 3/50. Iteration: 251/625. Cls loss: 767.679. Reg loss: 2.224. Seg loss: 1.064. Total loss: 770.967
2023-05-03 12:38:15,952 INFO Step: 1600. Epoch: 3/50. Iteration: 351/625. Cls loss: 1030.489. Reg loss: 2.949. Seg loss: 1.551. Total loss: 1034.988
2023-05-03 12:39:28,085 INFO Step: 1700. Epoch: 3/50. Iteration: 451/625. Cls loss: 648.110. Reg loss: 3.446. Seg loss: 1.492. Total loss: 653.047
2023-05-03 12:40:38,588 INFO Step: 1800. Epoch: 3/50. Iteration: 551/625. Cls loss: 3878.937. Reg loss: 3.106. Seg loss: 1.421. Total loss: 3883.465
2023-05-03 12:41:30,790 INFO Validating...
2023-05-03 12:56:52,114 INFO Val. Epoch: 3/50. Classification loss: 1173.21667. Regression loss: 2.92030. Segmentation loss: 1.48756. Total loss: 1177.62453
2023-05-03 12:56:52,262 INFO Epoch 4/50
2023-05-03 12:57:17,266 INFO Step: 1900. Epoch: 4/50. Iteration: 26/625. Cls loss: 2305.864. Reg loss: 3.871. Seg loss: 1.202. Total loss: 2310.938
2023-05-03 12:58:27,435 INFO Saved checkpoint to: ./logs/onlybdd10k_FT_v0_bs_16_with_MUNIT_5_outputs/2023_0503_1044_13/checkpoints/hybridnets-d3_3_2000.pth
2023-05-03 12:58:27,873 INFO Step: 2000. Epoch: 4/50. Iteration: 126/625. Cls loss: 1648.236. Reg loss: 2.693. Seg loss: 1.056. Total loss: 1651.985
2023-05-03 12:59:40,665 INFO Step: 2100. Epoch: 4/50. Iteration: 226/625. Cls loss: 796.178. Reg loss: 2.361. Seg loss: 0.969. Total loss: 799.509
2023-05-03 13:00:50,956 INFO Step: 2200. Epoch: 4/50. Iteration: 326/625. Cls loss: 1112.203. Reg loss: 2.361. Seg loss: 1.188. Total loss: 1115.752
2023-05-03 13:02:04,354 INFO Step: 2300. Epoch: 4/50. Iteration: 426/625. Cls loss: 879.091. Reg loss: 3.163. Seg loss: 1.235. Total loss: 883.488
2023-05-03 13:03:14,799 INFO Step: 2400. Epoch: 4/50. Iteration: 526/625. Cls loss: 1074.645. Reg loss: 2.719. Seg loss: 1.046. Total loss: 1078.409
2023-05-03 13:04:24,533 INFO Saved checkpoint to: ./logs/onlybdd10k_FT_v0_bs_16_with_MUNIT_5_outputs/2023_0503_1044_13/checkpoints/hybridnets-d3_3_2500.pth
2023-05-03 13:04:24,535 INFO Validating...
2023-05-03 13:19:46,634 INFO Val. Epoch: 4/50. Classification loss: 1146.30048. Regression loss: 2.91422. Segmentation loss: 1.33610. Total loss: 1150.55081
2023-05-03 13:19:46,795 INFO Epoch 5/50
2023-05-03 13:19:54,372 INFO Step: 2500. Epoch: 5/50. Iteration: 1/625. Cls loss: 1285.354. Reg loss: 3.661. Seg loss: 1.085. Total loss: 1290.100
2023-05-03 13:21:05,371 INFO Step: 2600. Epoch: 5/50. Iteration: 101/625. Cls loss: 1988.891. Reg loss: 2.923. Seg loss: 0.828. Total loss: 1992.642
2023-05-03 13:22:18,359 INFO Step: 2700. Epoch: 5/50. Iteration: 201/625. Cls loss: 774.977. Reg loss: 3.920. Seg loss: 0.940. Total loss: 779.837
2023-05-03 13:23:29,349 INFO Step: 2800. Epoch: 5/50. Iteration: 301/625. Cls loss: 888.863. Reg loss: 2.857. Seg loss: 1.081. Total loss: 892.801
2023-05-03 13:24:42,409 INFO Step: 2900. Epoch: 5/50. Iteration: 401/625. Cls loss: 777.382. Reg loss: 2.818. Seg loss: 0.983. Total loss: 781.183
2023-05-03 13:25:53,520 INFO Saved checkpoint to: ./logs/onlybdd10k_FT_v0_bs_16_with_MUNIT_5_outputs/2023_0503_1044_13/checkpoints/hybridnets-d3_4_3000.pth
2023-05-03 13:25:53,837 INFO Step: 3000. Epoch: 5/50. Iteration: 501/625. Cls loss: 914.370. Reg loss: 2.416. Seg loss: 1.062. Total loss: 917.849
2023-05-03 13:27:06,484 INFO Step: 3100. Epoch: 5/50. Iteration: 601/625. Cls loss: 1957.183. Reg loss: 3.069. Seg loss: 0.908. Total loss: 1961.160
2023-05-03 13:27:20,657 INFO Validating...
2023-05-03 13:42:34,708 INFO Val. Epoch: 5/50. Classification loss: 1118.38583. Regression loss: 2.90315. Segmentation loss: 1.21394. Total loss: 1122.50292
2023-05-03 13:42:34,859 INFO Epoch 6/50
2023-05-03 13:43:34,420 INFO Step: 3200. Epoch: 6/50. Iteration: 76/625. Cls loss: 875.353. Reg loss: 2.998. Seg loss: 0.690. Total loss: 879.042
2023-05-03 13:44:44,288 INFO Step: 3300. Epoch: 6/50. Iteration: 176/625. Cls loss: 502.815. Reg loss: 2.902. Seg loss: 0.865. Total loss: 506.582
2023-05-03 13:45:55,999 INFO Step: 3400. Epoch: 6/50. Iteration: 276/625. Cls loss: 2047.422. Reg loss: 2.798. Seg loss: 0.736. Total loss: 2050.957
2023-05-03 13:47:05,010 INFO Saved checkpoint to: ./logs/onlybdd10k_FT_v0_bs_16_with_MUNIT_5_outputs/2023_0503_1044_13/checkpoints/hybridnets-d3_5_3500.pth
2023-05-03 13:47:05,395 INFO Step: 3500. Epoch: 6/50. Iteration: 376/625. Cls loss: 929.031. Reg loss: 2.531. Seg loss: 1.287. Total loss: 932.849
2023-05-03 13:48:17,258 INFO Step: 3600. Epoch: 6/50. Iteration: 476/625. Cls loss: 2278.974. Reg loss: 2.211. Seg loss: 1.067. Total loss: 2282.252
2023-05-03 16:00:35,107 INFO Step: 3700. Epoch: 6/50. Iteration: 576/625. Cls loss: 985.040. Reg loss: 2.617. Seg loss: 0.955. Total loss: 988.612
2023-05-03 16:01:09,266 INFO Validating...
2023-05-03 16:16:31,534 INFO Val. Epoch: 6/50. Classification loss: 1089.39601. Regression loss: 2.90310. Segmentation loss: 1.10941. Total loss: 1093.40851
2023-05-03 16:16:31,694 INFO Epoch 7/50
2023-05-03 16:17:14,507 INFO Step: 3800. Epoch: 7/50. Iteration: 51/625. Cls loss: 534.741. Reg loss: 3.555. Seg loss: 0.835. Total loss: 539.131
2023-05-03 16:18:25,137 INFO Step: 3900. Epoch: 7/50. Iteration: 151/625. Cls loss: 645.483. Reg loss: 2.801. Seg loss: 1.048. Total loss: 649.333
2023-05-03 16:19:37,876 INFO Saved checkpoint to: ./logs/onlybdd10k_FT_v0_bs_16_with_MUNIT_5_outputs/2023_0503_1044_13/checkpoints/hybridnets-d3_6_4000.pth
2023-05-03 16:19:38,325 INFO Step: 4000. Epoch: 7/50. Iteration: 251/625. Cls loss: 734.357. Reg loss: 2.209. Seg loss: 0.746. Total loss: 737.312
2023-05-03 16:20:48,193 INFO Step: 4100. Epoch: 7/50. Iteration: 351/625. Cls loss: 1218.138. Reg loss: 2.340. Seg loss: 1.204. Total loss: 1221.682
2023-05-03 16:22:01,435 INFO Step: 4200. Epoch: 7/50. Iteration: 451/625. Cls loss: 736.143. Reg loss: 3.371. Seg loss: 0.779. Total loss: 740.293
2023-05-03 16:23:12,013 INFO Step: 4300. Epoch: 7/50. Iteration: 551/625. Cls loss: 3527.843. Reg loss: 2.394. Seg loss: 1.022. Total loss: 3531.259
2023-05-03 16:24:03,814 INFO Validating...
2023-05-03 16:39:20,675 INFO Val. Epoch: 7/50. Classification loss: 1059.59240. Regression loss: 2.90063. Segmentation loss: 1.02449. Total loss: 1063.51752
2023-05-03 16:39:20,961 INFO Epoch 8/50
2023-05-03 16:39:46,275 INFO Step: 4400. Epoch: 8/50. Iteration: 26/625. Cls loss: 990.037. Reg loss: 3.004. Seg loss: 0.816. Total loss: 993.858
2023-05-03 16:40:56,095 INFO Saved checkpoint to: ./logs/onlybdd10k_FT_v0_bs_16_with_MUNIT_5_outputs/2023_0503_1044_13/checkpoints/hybridnets-d3_7_4500.pth
2023-05-03 16:40:56,400 INFO Step: 4500. Epoch: 8/50. Iteration: 126/625. Cls loss: 1206.601. Reg loss: 2.602. Seg loss: 0.912. Total loss: 1210.115
2023-05-03 16:42:09,138 INFO Step: 4600. Epoch: 8/50. Iteration: 226/625. Cls loss: 797.131. Reg loss: 2.100. Seg loss: 0.516. Total loss: 799.747
2023-05-03 16:43:19,826 INFO Step: 4700. Epoch: 8/50. Iteration: 326/625. Cls loss: 1121.967. Reg loss: 2.498. Seg loss: 0.783. Total loss: 1125.249
2023-05-03 16:44:32,605 INFO Step: 4800. Epoch: 8/50. Iteration: 426/625. Cls loss: 938.182. Reg loss: 3.385. Seg loss: 1.117. Total loss: 942.685
2023-05-03 16:45:43,672 INFO Step: 4900. Epoch: 8/50. Iteration: 526/625. Cls loss: 765.460. Reg loss: 3.289. Seg loss: 0.698. Total loss: 769.447
2023-05-03 16:46:52,697 INFO Saved checkpoint to: ./logs/onlybdd10k_FT_v0_bs_16_with_MUNIT_5_outputs/2023_0503_1044_13/checkpoints/hybridnets-d3_7_5000.pth
2023-05-03 16:46:52,699 INFO Validating...
